{
  "pipeline": {
    "name": "WLPR Forecasting - Improved",
    "version": "3.0",
    "description": "Enhanced physics-informed TSMixerx with advanced features and adaptive loss"
  },
  
  "data": {
    "data_path": "MODEL_22.09.25.csv",
    "coords_path": "coords.txt",
    "distances_path": "well_distances.xlsx",
    "validation_enabled": true,
    "min_history": 60,
    "freq": "MS",
    
    "_NEW_preprocessing": {
      "use_physics_aware": true,
      "detect_structural_breaks": true,
      "structural_break_threshold": 0.7,
      "multivariate_outlier_detection": true,
      "outlier_contamination": 0.05,
      "smooth_rates": true,
      "savgol_window": 7,
      "savgol_polyorder": 2
    }
  },
  
  "model": {
    "type": "tsmixerx",
    "horizon": 6,
    "input_size": 48,
    "n_block": 2,
    "ff_dim": 64,
    "dropout": 0.1,
    "learning_rate": 0.0005,
    "max_steps": 250,
    "batch_size": 16,
    "scaler_type": "standard",
    
    "_NEW_alternatives": {
      "comment": "Set 'type' to one of: 'tsmixerx', 'multiscale', 'attention', 'ensemble'",
      "multiscale_config": {
        "scales": [1, 2, 4],
        "hidden_dim": 64
      },
      "attention_config": {
        "attention_heads": 4,
        "attention_hidden_dim": 32
      },
      "ensemble_config": {
        "n_models": 3,
        "mode": "weighted",
        "weights": [0.4, 0.3, 0.3]
      }
    }
  },
  
  "physics": {
    "enabled": true,
    "loss_type": "adaptive_physics",
    
    "_UPDATED_adaptive_scheduling": {
      "physics_weight_init": 0.01,
      "physics_weight_max": 0.3,
      "adaptive_schedule": "cosine",
      "warmup_steps": 50
    },
    
    "_UPDATED_multi_term_physics": {
      "injection_coeff": 0.05,
      "damping": 0.01,
      "diffusion_coeff": 0.001,
      "smoothing_weight": 0.01,
      "boundary_weight": 0.05
    },
    
    "features": ["inj_wwir_lag_weighted"],
    "base_loss": "huber",
    
    "_NEW_ensemble_physics": {
      "enabled": false,
      "components": [
        {"physics_weight_max": 0.1, "injection_coeff": 0.03, "damping": 0.01},
        {"physics_weight_max": 0.2, "injection_coeff": 0.05, "damping": 0.02},
        {"physics_weight_max": 0.3, "injection_coeff": 0.07, "damping": 0.015}
      ]
    }
  },
  
  "injection_features": {
    "top_k": 5,
    "kernel_type": "idw",
    "kernel_p": 2.0,
    "calibrate": true,
    "use_crm": true,
    "tau_bound_multiplier": 2.0,
    "kernel_candidates": [
      {
        "type": "idw",
        "calibrate": true,
        "params": {"p": 1.5},
        "param_grid": {"p": [0.5, 1.0, 1.5, 2.0, 3.0, 4.0]}
      },
      {
        "type": "exponential",
        "calibrate": true,
        "params": {"scale": 400.0},
        "param_grid": {"scale": [200.0, 400.0, 600.0, 800.0, 1000.0]}
      },
      {
        "type": "gaussian",
        "calibrate": true,
        "params": {"scale": 400.0},
        "param_grid": {"scale": [200.0, 400.0, 600.0, 800.0, 1000.0]}
      },
      {
        "type": "matern",
        "calibrate": true,
        "params": {"scale": 400.0, "nu": 1.5},
        "param_grid": {"scale": [200.0, 400.0, 600.0], "nu": [0.5, 1.5, 2.5]}
      }
    ]
  },
  
  "features": {
    "_NEW_advanced_features": {
      "interaction_features": {
        "enabled": true,
        "pairs": [
          ["wlpr", "wbhp"],
          ["wlpr", "inj_wwir_lag_weighted"],
          ["womt", "wwit"],
          ["womr", "fw"]
        ]
      },
      
      "spatial_features": {
        "enabled": true,
        "include_depth": true,
        "include_distance_from_center": true,
        "include_quadrants": true
      },
      
      "rolling_statistics": {
        "enabled": true,
        "feature_cols": ["wlpr", "wbhp", "inj_wwir_lag_weighted"],
        "windows": [3, 6, 12],
        "statistics": ["mean", "std", "min", "max"]
      },
      
      "pressure_features": {
        "enabled": true,
        "compute_gradient": true,
        "compute_productivity_index": true
      },
      
      "fourier_features": {
        "enabled": true,
        "n_frequencies": 3
      },
      
      "ts_embeddings": {
        "enabled": false,
        "window": 12,
        "n_components": 3
      },
      
      "decline_features": {
        "enabled": true,
        "include_peak_features": true,
        "include_decline_rate": true,
        "include_stage_classification": true
      }
    },
    
    "hist_exog": [
      "wlpt", "womt", "womr", "wwir", "wwit", "wthp", "wbhp",
      "wlpt_diff", "womt_diff", "wwit_diff",
      "inj_wwir_lag_weighted", "inj_wwit_diff_lag_weighted", "inj_wwir_crm_weighted",
      "_NEW_wlpr_x_wbhp", "_NEW_wlpr_x_inj_wwir_lag_weighted",
      "_NEW_wlpr_ma3", "_NEW_wlpr_ma6", "_NEW_wlpr_ma12",
      "_NEW_productivity_index", "_NEW_wbhp_gradient"
    ],
    
    "futr_exog": [
      "month_sin", "month_cos", "time_idx", "type_prod", "type_inj",
      "wwir", "wwit", "wwit_diff",
      "inj_wwir_lag_weighted", "inj_wwit_diff_lag_weighted", "inj_wwir_crm_weighted",
      "_NEW_fourier_sin_1", "_NEW_fourier_cos_1"
    ],
    
    "static_exog": [
      "x", "y", "z",
      "_NEW_well_depth", "_NEW_dist_from_center",
      "_NEW_quadrant_0", "_NEW_quadrant_1", "_NEW_quadrant_2", "_NEW_quadrant_3"
    ]
  },
  
  "metrics": {
    "_NEW_reservoir_metrics": {
      "enabled": true,
      "decline_curve_metrics": true,
      "pressure_metrics": true,
      "injection_efficiency_metrics": true,
      "waterflood_metrics": true,
      "reliability_metrics": true
    },
    
    "standard_metrics": [
      "mae", "rmse", "mape", "smape", "wmape", "mase",
      "r2", "adjusted_r2", "nse", "kge", "pbias",
      "index_of_agreement", "correlation"
    ]
  },
  
  "validation": {
    "cv_enabled": true,
    "cv_folds": 6,
    "cv_step": 6,
    "cv_type": "walk_forward",
    "val_horizon": 6,
    "early_stop_patience_steps": 50,
    "val_check_steps": 20,
    
    "_NEW_diagnostics": {
      "residual_analysis": true,
      "statistical_testing": true,
      "per_well_analysis": true
    }
  },
  
  "optimizer": {
    "name": "adamw",
    "weight_decay": 0.0001,
    "kwargs": {
      "betas": [0.9, 0.99]
    },
    
    "_NEW_lr_finder": {
      "enabled": false,
      "min_lr": 1e-7,
      "max_lr": 1e-2,
      "num_training_steps": 100
    }
  },
  
  "scheduler": {
    "name": "onecycle",
    "kwargs": {
      "pct_start": 0.3,
      "div_factor": 10.0
    },
    
    "_NEW_alternatives": {
      "cosine_annealing_warm_restarts": {
        "T_0": 50,
        "T_mult": 2,
        "eta_min": 1e-6
      }
    }
  },
  
  "output": {
    "output_dir": "artifacts",
    "save_predictions": true,
    "save_metrics": true,
    "save_metadata": true,
    "generate_reports": true,
    
    "_NEW_enhanced_outputs": {
      "save_attention_weights": true,
      "save_feature_importance": true,
      "save_residual_diagnostics": true,
      "save_per_well_metrics": true
    }
  },
  
  "logging": {
    "level": "INFO",
    "console": true,
    "file_logging": true,
    "rotation": "size",
    "max_bytes": 10485760,
    "backup_count": 5,
    "colored": true
  },
  
  "mlflow": {
    "enabled": true,
    "tracking_uri": "file:./mlruns",
    "experiment_name": "wlpr_forecasting_improved",
    "run_name": null,
    
    "_NEW_auto_logging": {
      "log_attention_weights": true,
      "log_feature_importance": true,
      "log_physics_loss_components": true
    }
  },
  
  "caching": {
    "enabled": true,
    "cache_dir": ".cache"
  },
  
  "hardware": {
    "accelerator": "auto",
    "devices": 1,
    "precision": "16-mixed",
    "num_workers": 0,
    "pin_memory": false
  },
  
  "_IMPROVEMENTS_INFO": {
    "version": "3.0",
    "date": "2025-10-04",
    "key_improvements": [
      "Adaptive physics loss with multi-term constraints",
      "Advanced feature engineering (interactions, spatial, multi-scale)",
      "Reservoir-specific metrics for petroleum engineering",
      "Enhanced preprocessing with physics awareness",
      "Support for alternative architectures (multiscale, attention, ensemble)"
    ],
    "expected_performance_gain": "+15-25% over v2.0 baseline",
    "research_basis": [
      "WellPINN (2025)",
      "TimeMixer (ICLR 2024)",
      "Temporal Fusion Transformer (2024)",
      "Comprehensive review of PIDL (2025)",
      "Automated Reservoir History Matching (2025)"
    ]
  }
}
