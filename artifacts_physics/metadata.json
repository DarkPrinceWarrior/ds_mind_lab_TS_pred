{
  "config": {
    "horizon": 6,
    "val_horizon": 6,
    "freq": "MS",
    "min_history": 60,
    "input_size": 48,
    "n_block": 2,
    "ff_dim": 64,
    "dropout": 0.1,
    "learning_rate": 0.0005,
    "max_steps": 250,
    "early_stop_patience_steps": 50,
    "val_check_steps": 20,
    "batch_size": 16,
    "windows_batch_size": 64,
    "scaler_type": "standard",
    "num_lr_decays": 2,
    "random_seed": 42,
    "cv_folds": 6,
    "cv_step": 6,
    "cv_enabled": true,
    "grad_clip_norm": 1.0,
    "grad_clip_value": null,
    "loss": "physics",
    "valid_loss": "smape",
    "weight_decay": 0.0001,
    "exclude_insample_y": false,
    "revin": true,
    "valid_batch_size": 32,
    "inference_windows_batch_size": 64,
    "start_padding_enabled": false,
    "training_data_availability_threshold": 0.1,
    "step_size": 1,
    "drop_last_loader": false,
    "physics_weight": 0.1,
    "physics_injection_coeff": 0.05,
    "physics_damping": 0.01,
    "physics_smoothing_weight": 0.0,
    "physics_features": [
      "inj_wwir_lag_weighted"
    ],
    "physics_base_loss": "huber",
    "inj_top_k": 5,
    "inj_kernel_type": "idw",
    "inj_kernel_p": 2.0,
    "inj_kernel_params": {},
    "inj_kernel_calibrate": true,
    "inj_kernel_param_grid": {},
    "inj_kernel_candidates": [
      {
        "type": "idw",
        "calibrate": true,
        "params": {
          "p": 1.5
        },
        "param_grid": {
          "p": [
            0.5,
            1.0,
            1.5,
            2.0,
            3.0,
            4.0
          ]
        }
      },
      {
        "type": "exponential",
        "calibrate": true,
        "params": {
          "scale": 400.0
        },
        "param_grid": {
          "scale": [
            200.0,
            400.0,
            600.0,
            800.0,
            1000.0
          ]
        }
      },
      {
        "type": "gaussian",
        "calibrate": true,
        "params": {
          "scale": 400.0
        },
        "param_grid": {
          "scale": [
            200.0,
            400.0,
            600.0,
            800.0,
            1000.0
          ]
        }
      },
      {
        "type": "matern",
        "calibrate": true,
        "params": {
          "scale": 400.0,
          "nu": 1.5
        },
        "param_grid": {
          "scale": [
            200.0,
            400.0,
            600.0,
            800.0
          ],
          "nu": [
            0.5,
            1.5,
            2.5
          ]
        }
      },
      {
        "type": "rational_quadratic",
        "calibrate": true,
        "params": {
          "scale": 400.0,
          "alpha": 1.0
        },
        "param_grid": {
          "scale": [
            200.0,
            400.0,
            600.0,
            800.0
          ],
          "alpha": [
            0.5,
            1.0,
            2.0
          ]
        }
      }
    ],
    "inj_distance_anisotropy": null,
    "inj_directional_bias": null,
    "use_crm_filter": true,
    "tau_bound_multiplier": 2.0,
    "lag_min_overlap": 6,
    "physics_estimates": null,
    "optimizer_name": "adamw",
    "optimizer_kwargs": {
      "betas": [
        0.9,
        0.99
      ]
    },
    "lr_scheduler_name": "onecycle",
    "lr_scheduler_kwargs": {
      "pct_start": 0.3,
      "div_factor": 10.0
    },
    "dataloader_kwargs": {
      "num_workers": 0,
      "pin_memory": false
    },
    "trainer_kwargs": {
      "accelerator": "gpu",
      "devices": 1,
      "precision": "16-mixed",
      "log_every_n_steps": 10,
      "gradient_clip_val": 1.0,
      "enable_model_summary": false
    },
    "hist_exog": [
      "wlpt",
      "womt",
      "womr",
      "wwir",
      "wwit",
      "wthp",
      "wbhp",
      "wlpt_diff",
      "womt_diff",
      "wwit_diff",
      "inj_wwir_lag_weighted",
      "inj_wwit_diff_lag_weighted",
      "inj_wwir_crm_weighted"
    ],
    "futr_exog": [
      "month_sin",
      "month_cos",
      "time_idx",
      "type_prod",
      "type_inj",
      "wwir",
      "wwit",
      "wwit_diff",
      "inj_wwir_lag_weighted",
      "inj_wwit_diff_lag_weighted",
      "inj_wwir_crm_weighted"
    ],
    "static_exog": [
      "x",
      "y",
      "z"
    ]
  },
  "target_wells": [
    "14",
    "22",
    "23",
    "27",
    "3",
    "31",
    "33",
    "35",
    "38",
    "40",
    "45",
    "48",
    "50"
  ],
  "test_start": "2022-06-01",
  "train_cutoff": "2022-05-01",
  "train_rows": 2353,
  "test_rows": 78,
  "kernel_selection": {
    "kernel_type": "idw",
    "kernel_params": {
      "p": 4.0
    },
    "kernel_score": 10.449543656138271
  },
  "injection_summary_path": "artifacts_physics\\injection_lag_summary.csv",
  "injection_pairs": 65,
  "pdf_reports": {
    "test_forecast": "artifacts_physics\\wlpr_forecasts.pdf",
    "full_history": "artifacts_physics\\wlpr_full_history.pdf",
    "residuals": "artifacts_physics\\wlpr_residuals.pdf"
  },
  "walk_forward_cv": {
    "folds": 6,
    "aggregate": {
      "mae": 8.743347045424676,
      "rmse": 15.32361282386461,
      "mape": 7.482465215966737,
      "smape": 7.637921772013258,
      "wmape": 5.714218373001069,
      "mase": 1.8992497580020773,
      "r2": 0.985670519149746,
      "nse": 0.985670519149746,
      "kge": 0.9521554593266737,
      "pbias": 2.0538523851417643,
      "index_of_agreement": 0.9963592154097233,
      "mean_bias_error": -3.1469782029250024,
      "correlation": 0.9948556688798476
    },
    "details_path": "artifacts_physics\\cv_metrics.json"
  }
}